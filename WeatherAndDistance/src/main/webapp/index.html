<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Show me Weather</title>
        <script src="http://code.jquery.com/jquery-latest.min.js"></script>
        <link rel="styleSheet" type="text/css" href="css/index.css">
    </head>

    <body>
        <div id="wrapper">
            <div id="map">

            </div>

            <div id="over_map_top">
                <div class="dropdown">
                    <button id="city-button" onclick="myFunction()" class="dropbtn">Select city</button>
                    <div id="myDropdown" class="dropdown-content">
                        <a class="dropbtnopt" href="#">Link 1</a>
                        <a class="dropbtnopt" href="#">Link 2</a>
                        <a class="dropbtnopt" href="#">Link 3</a>
                    </div>
                </div>
            </div>
            
            <div id="over_map_bottom">
                
            </div>
         </div>
        
        <script>
            function loadCities() {
                $.getJSON('cities/ajax', {'command': 'get_cities'}, function (data) {
                    var dropdown = $("#myDropdown");
                    
                    $.each(data, function (i, city) {
                        $('<a>', { 
                            "class": 'dropbtnopt',
                            text : city
                        }).appendTo(dropdown)
                    })
                })
            };
            
            function myFunction() {
                document.getElementById("myDropdown").classList.toggle("show");
            }

            window.onclick = function(event) {
                if (event.target.matches('.dropbtnopt')) {
                    var cityButton = document.getElementById('city-button');
                    var cityName = event.target.innerHTML;
                    
                    cityButton.innerHTML = cityName;
                    
                    // reset dropdown
                    var dropdowns = document.getElementsByClassName("dropdown-content");
                    var i;
                    for (i = 0; i < dropdowns.length; i++) {
                        var openDropdown = dropdowns[i];

                        if (openDropdown.classList.contains('show')) {
                            openDropdown.classList.remove('show');
                        }
                    }
                }
            }
            
            $(document).ready(function () {
                loadCities();
            });
        </script>
        <script>
            function initMap() {
              var uluru = {lat: -25.363, lng: 131.044};
              var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 4,
                center: uluru,
                streetViewControl: false,
                mapTypeControl: false
              });
              
              var marker = new google.maps.Marker({
                position: uluru,
                map: map
              });
            };
        </script>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCAc2HFm1gVsGgu1kSOGkVuO-iv5wSc_KA&callback=initMap">
        </script>
    </body>
</html>
